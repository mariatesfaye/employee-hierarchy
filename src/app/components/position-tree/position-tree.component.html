<div class="page">
  <div class="header">
    <h2>Perago â€” Employee Positions Hierarchy</h2>
    <button nz-button nzType="primary" (click)="openCreate()">
      Create Position
    </button>
  </div>

  <nz-spin [nzSpinning]="loading">
    <nz-tree
      *ngIf="nodes.length > 0"
      [nzData]="nodes"
      nzBlockNode
      [nzExpandAll]="true"
      (nzClick)="onNodeClick($event)">
    </nz-tree>

    <div *ngIf="nodes.length === 0 && !loading" 
         class="empty-state">
      <nz-empty nzNotFoundContent="No positions found">
        <button nz-button nzType="primary" (click)="openCreate()">
          Create First Position
        </button>
      </nz-empty>
    </div>
  </nz-spin>

  <nz-drawer
    [nzVisible]="drawerVisible"
    nzPlacement="right"
    [nzTitle]="isNew ? 'Create Position' : ('Edit: ' + (selectedPosition?.name || 'Position'))"
    (nzOnClose)="closeDrawer()"
    [nzWidth]="520"
    nzClosable>
    
    <div *nzDrawerContent>
      <app-position-form
        [position]="selectedPosition"
        [allPositions]="positions"
        [isNew]="isNew"
        (saved)="onSaved()"
        (deleted)="onDeleted()"
        (cancelled)="closeDrawer()">
      </app-position-form>
    </div>
  </nz-drawer>
</div>